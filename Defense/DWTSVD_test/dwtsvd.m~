function img = dwtsvd(original, mark)
    
    %first part (image splitting)
    [LL,LH,HL,HH] = dwt2(original,'haar');
    
    [ULH,SLH,VLH] = svd(LH);
    [UHL,SHL,VHL] = svd(HL);
    
    %second part (watermark processing)
    mark = bitmark2gs(mark);
    mark = mark(:)';
    
    %[WL,WH] = dwt(mark,'haar');
    WL = mark(1,1:256);
    WH = mark(1,257:512);
    
    %third part, watermark embedding
    WSHL = zeros(256);
    WSLH = zeros(256);
    
    a = 5;
    for i=(1:256)
        WSHL(i,i) = SHL(i,i) +0%a*WL(i);
        WSLH(i,i) = SLH(i,i) + 10;%a*WH(i);
    end
        
    WLH = ULH*WSLH*VLH';
    WHL = UHL*WSHL*VHL';
    
img = uint8(idwt2(LL,WLH,WHL,HH,'haar'));